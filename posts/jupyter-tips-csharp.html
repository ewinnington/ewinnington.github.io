
<!DOCTYPE html>
<!--
	Phantom by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="en">

	<head>
		<title>Eric Winnington - Tips and tricks for C# Jupyter notebook</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />		
        <link href="/assets/css/highlight.css" rel="stylesheet">
		<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
        <link href="/assets/css/override.css" rel="stylesheet" />

		<meta name="description" content="A collection of thoughts, code and snippets." />
		<link type="application/rss+xml" rel="alternate" title="Eric Winnington" href="/feed.rss" />
				<link type="application/atom+xml" rel="alternate" title="Eric Winnington" href="/feed.atom" />
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" href="/favicon.ico" type="image/x-icon">

		<meta name="application-name" content="Eric Winnington" />
		<meta name="msapplication-tooltip" content="Eric Winnington" />
		<meta name="msapplication-starturl" content="/" />

		<meta property="og:title" content="Eric Winnington - Tips and tricks for C# Jupyter notebook" /> 
		<meta property="og:type" content="website" />
		<meta property="og:url" content="http://ewinnington.github.io/posts/jupyter-tips-csharp" />
		<!-- TODO: More social graph meta tags -->

        <script src="/assets/js/highlight.pack.js"></script>   
		
        <meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@ewinnington" />
<meta name="twitter:title" content="Eric Winnington - Tips and tricks for C# Jupyter notebook" />
<meta name="twitter:description" content="A collection of thoughts, code and snippets." />

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
		
	</head>

	<body>
		<!-- Wrapper -->
		<div id="wrapper">

			<!-- Header -->
			<header id="header">
				<div class="inner">

					<!-- Logo -->
					<a href="/" class="logo">
						<span class="title">Eric Winnington</span>
					</a>

					<!-- Nav -->
					<nav>
						<ul>
							<li><a href="#menu">Menu</a></li>
						</ul>
					</nav>

				</div>
			</header>

			<!-- Menu -->
			<nav id="menu">
				<h2>Menu</h2>
				<ul>
					        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About Me</a></li>
        <li><a href="/videos">Videos on programming</a></li>

				</ul>
			</nav>

			<!-- Main -->
			<div id="main">
				<div class="inner">

    
<header>
    <h1>Tips and tricks for C# Jupyter notebook</h1>
            <p><em>Published on Sunday, 17 November 2019</em></p>
            <ul class="actions small">
                    <li><a role="button" href="/tags/CSharp" class="button small">CSharp</a></li>
                    <li><a role="button" href="/tags/Dotnet-try" class="button small">Dotnet try</a></li>
                    <li><a role="button" href="/tags/Jupyter-notebook" class="button small">Jupyter notebook</a></li>
        </ul>     
</header>

					
					<div id="content">
						

<p>As I use the Jupyter notebook with C# integration, I'll add to this list of tricks as I discover them.</p>
<h2 id="adding-collapsed-details-to-jupyter-notebooks">Adding collapsed details to jupyter notebooks</h2>
<p>I wanted to show hints and answers to questions in the jupyter notebook, but I didn't want them to be directly visible without interaction.</p>
<p><img src="/posts/images/jupyter-notebook-tips/collapsed_details.png" class="img-fluid" alt="collapsed" /></p>
<p><img src="/posts/images/jupyter-notebook-tips/expanded_details.png" class="img-fluid" alt="expanded" /></p>
<p>This was done by creating a markdown block with an HTML section inside. When interacted with, the section expands.</p>
<pre><code class="language-HTML">&lt;details&gt;
&lt;summary&gt;Summary of the fold&lt;/summary&gt;
  ... Content shown after the fold ...
&lt;/details&gt;
</code></pre>
<details>
<summary>Summary of the fold</summary>
  ... Content shown after the fold ...
</details>
<p>And since it's just HTML, it works anywere, including here.</p>
<h2 id="display-function">display() function</h2>
<p>The C# kernel embedded in Jupyter has some functions that control the output to the cells of the notebook when executed. One of these functions is  <code>display()</code>.</p>
<h3 id="tables">Tables</h3>
<p>It shows properties of objects or lists in a table format. In my linear programming solver examples, I used this command to make a table with the name and value of each problem variable.</p>
<pre><code class="language-CSharp"> display(solver.variables().Select(a =&gt; new { Name  = a.Name(), Value = a.SolutionValue() })); 
</code></pre>
<p><img src="/posts/images/lp/10-6.png" class="img-fluid" alt="var_table" /></p>
<p>This is an ideal case for <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/anonymous-types">C#'s anonymous objects</a> and <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/data-transformations-with-linq">linq to select the object properties</a> that you want to see in the table. Adding <code>using System.Linq;</code> to your references will allow you to use the <code>.Select( x =&gt; new { PropertyHeader = x.PropertyValue, ... })</code> linq command.</p>
<h3 id="svgs">SVGs</h3>
<p>I discovered the <code>display(HTML())</code> function allows you to pass items such as SVGs from inside C# to be rendered below the block. Two examples are the SVG image triange and the bar chart. On top of that, the bar chart is stylable by CSS.</p>
<p><img src="/posts/images/jupyter-notebook-tips/svg_img.png" class="img-fluid" alt="expanded" /></p>
<p>The SVG code is generated inside C#, then the variable containing the SVG is displayed.</p>
<p><img src="/posts/images/jupyter-notebook-tips/bar_chart.png" class="img-fluid" alt="expanded" /></p>
<p>Finally, you can add create a cell containing some CSS (with <code>%%html</code>) , which when executed will change the chart as shown.
<img src="/posts/images/jupyter-notebook-tips/bar_chart_with_css.png" class="img-fluid" alt="expanded" />
<img src="/posts/images/jupyter-notebook-tips/bar_chart_css.png" class="img-fluid" alt="expanded" /></p>
<h2 id="magic">Magic</h2>
<p>The <code>%lsmagic</code> command shows a list of commands available to use in code blocks.</p>
<p><img src="/posts/images/jupyter-notebook-tips/lsmagic.png" class="img-fluid" alt="expanded" /></p>
<h3 id="javascript">%%javascript</h3>
<p>You can execute javascript with the <code>%%javascript</code> magic.</p>
<p><img src="/posts/images/jupyter-notebook-tips/javascript_hello.png" class="img-fluid" alt="collapsed" /></p>
<p><img src="/posts/images/jupyter-notebook-tips/javascript_hello_active.png" class="img-fluid" alt="collapsed" /></p>
<h3 id="html">%%html</h3>
<p>As previously mentioned, the %%html command will allow you to add CSS blocks and any other HTML output directly into the Jupyter output cell.</p>
<h3 id="time">%%time</h3>
<p>Gives you access to the wall time. Actual time took to execution of the cell.</p>
<h3 id="whos">%whos</h3>
<p>Gives you access to the list of currently defined variable in the memory of the notebook. Also lists the type and value (as a &quot;toString() representation) of the objects.</p>
<h3 id="fsharp">%%fsharp</h3>
<p>You can intermingle C# and F# code inside one notebook, as long as they are in different cells. You can switch to F# by prefixing the cell with <code>%%fsharp</code></p>
<pre><code class="language-%%fsharp">let main argv =
    display &quot;Hello World from F#!&quot;
    0 
main()
</code></pre>
<p><img src="/posts/images/jupyter-notebook-tips/f_sharp.png" class="img-fluid" alt="collapsed" /></p>
<h2 id="graphing-from-c">Graphing from C#</h2>
<p>We can chart using <code>Xplot.Plotly</code>.</p>
<pre><code class="language-CSharp">//Install XPlot package
#r &quot;nuget:XPlot.Plotly,2.0.0&quot;
using XPlot.Plotly;
</code></pre>
<p>Input data:</p>
<pre><code class="language-CSharp">DateTime now = DateTime.Now; 
var imax = 8760; 
var rand = new Random(); 
double[] data = Enumerable.Range(1, imax).Select(x =&gt; 20.0 + 15.0 * Math.Sin(x/60.0) + 12 * rand.NextDouble()).ToArray(); 
DateTime[] tp = Enumerable.Range(1, imax).Select(x =&gt; now.AddHours(x) ).ToArray(); 

int totalNumberForBarChart = 3;
double[] actualFares = new [] {3.4, 12.3, 20.42};
double[] predictionFares = new [] {7.4, 14.3, 18.42};
int[] elements = Enumerable.Range(0, totalNumberForBarChart).ToArray();
</code></pre>
<p>my samples are here <a href="https://github.com/ewinnington/noteb/blob/master/Charts_CSharp.ipynb">C# charts</a></p>
<h3 id="two-bar-plot">Two bar plot</h3>
<p><img src="/posts/images/jupyter-notebook-tips/bar.png" class="img-fluid" alt="bar" /></p>
<pre><code class="language-CSharp">// Define group for Actual values
var ActualValuesGroupBarGraph = new Graph.Bar()
{
   x = elements,
   y = actualFares,
   name = &quot;Actual&quot;
};
 
// Define group for Prediction values
var PredictionValuesGroupBarGraph = new Graph.Bar()
{
   x = elements,
   y = predictionFares,
   name = &quot;Predicted&quot;
};
 
var chart = Chart.Plot(new[] {ActualValuesGroupBarGraph, PredictionValuesGroupBarGraph});
var layout = new Layout.Layout(){barmode = &quot;group&quot;, title=&quot;Actual fares vs. Predicted fares Comparison&quot;};
chart.WithLayout(layout);
chart.WithXTitle(&quot;Cases&quot;);
chart.WithYTitle(&quot;Fare&quot;);
chart.WithLegend(true);
chart.Width = 700;
chart.Height = 400;
 
display(chart);
</code></pre>
<h3 id="histogram">Histogram</h3>
<p><img src="/posts/images/jupyter-notebook-tips/histogram.png" class="img-fluid" alt="hist" /></p>
<pre><code class="language-CSharp">var faresHistogram = Chart.Plot(new Graph.Histogram(){x = data, autobinx = false, nbinsx = 20});
var layout = new Layout.Layout(){title=&quot;Distribution of taxi trips per cost&quot;};
faresHistogram.WithLayout(layout);

display(faresHistogram);
</code></pre>
<h3 id="scatter">Scatter</h3>
<p><img src="/posts/images/jupyter-notebook-tips/scatter.png" class="img-fluid" alt="scatter" /></p>
<pre><code class="language-CSharp">var chart = Chart.Plot(
    new Graph.Scatter()
    {
        x = actualFares,
        y = predictionFares,
        mode = &quot;markers&quot;,
        marker = new Graph.Marker()
        {
            color = predictionFares,
            colorscale = &quot;Jet&quot;
        }
    }
);

var layout = new Layout.Layout(){title=&quot;Plot Time vs. Distance &amp; color scale on Fares&quot;};
chart.WithLayout(layout);
chart.Width = 500;
chart.Height = 500;
chart.WithLegend(true);

display(chart);
</code></pre>
<h3 id="line-chart-with-scatter">Line chart with scatter</h3>
<p><img src="/posts/images/jupyter-notebook-tips/lines.png" class="img-fluid" alt="lines" /></p>
<pre><code class="language-CSharp">var linedUp = new Graph.Scatter()
{
    x = tp,
    y = data,
    mode = &quot;lines&quot;,
};

var chart = Chart.Plot(linedUp);
chart.WithXTitle(&quot;Date&quot;);
chart.WithYTitle(&quot;Value&quot;);
chart.WithLegend(true);
chart.Width = 1200;
chart.Height = 600;
display(chart);
</code></pre>


<hr>
					</div>
				</div>
			</div>

			<!-- Footer -->
			<footer id="footer">
				<div class="inner">
    <section>
        <h2>Feeds</h2>
        <ul class="actions small vertical">
            <li><a href="/feed.rss" class="button small"><i class="fa fa-rss"></i> RSS Feed</a></li>
                        <li><a href="/feed.atom" class="button small"><i class="fa fa-rss"></i> Atom Feed</a></li>
        </ul>
    </section>
    <section>
    </section>
    <ul class="copyright">
        <li>Copyright © 2024</li>
        <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
        <li><a href="https://wyam.io">Generated by Wyam</a></li>
    </ul>
</div>

			</footer>

		</div>
		
		

		<!-- Scripts -->
		<script>hljs.initHighlightingOnLoad();</script>
		<script src="/assets/js/jquery.min.js"></script>
		<script src="/assets/js/skel.min.js"></script>
		<script src="/assets/js/util.js"></script>
		<!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
		<script src="/assets/js/main.js"></script>

	</body>

</html>
