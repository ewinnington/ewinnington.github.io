
<!DOCTYPE html>
<!--
	Phantom by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="en">

	<head>
		<title>Eric Winnington</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />		
        <link href="/assets/css/highlight.css" rel="stylesheet">
		<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
        <link href="/assets/css/override.css" rel="stylesheet" />

		<meta name="description" content="A collection of thoughts, code and snippets." />
		<link type="application/rss+xml" rel="alternate" title="Eric Winnington" href="/feed.rss" />
				<link type="application/atom+xml" rel="alternate" title="Eric Winnington" href="/feed.atom" />
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" href="/favicon.ico" type="image/x-icon">

		<meta name="application-name" content="Eric Winnington" />
		<meta name="msapplication-tooltip" content="Eric Winnington" />
		<meta name="msapplication-starturl" content="/" />

		<meta property="og:title" content="Eric Winnington" /> 
		<meta property="og:type" content="website" />
		<meta property="og:url" content="http://ewinnington.github.io/" />
		<!-- TODO: More social graph meta tags -->

        <script src="/assets/js/highlight.pack.js"></script>   
		
        <meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@ewinnington" />
<meta name="twitter:title" content="Eric Winnington" />
<meta name="twitter:description" content="A collection of thoughts, code and snippets." />

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
		
	</head>

	<body>
		<!-- Wrapper -->
		<div id="wrapper">

			<!-- Header -->
			<header id="header">
				<div class="inner">

					<!-- Logo -->
					<a href="/" class="logo">
						<span class="title">Eric Winnington</span>
					</a>

					<!-- Nav -->
					<nav>
						<ul>
							<li><a href="#menu">Menu</a></li>
						</ul>
					</nav>

				</div>
			</header>

			<!-- Menu -->
			<nav id="menu">
				<h2>Menu</h2>
				<ul>
					        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About Me</a></li>
        <li><a href="/videos">Videos on programming</a></li>

				</ul>
			</nav>

			<!-- Main -->
			<div id="main">
				<div class="inner">

    <header>
        <h1>A collection of thoughts, code and snippets.</h1>
    </header>

					
					<div id="content">
						
<div class="row">
    <div class="8u 12u$(medium)">
                <div>
                    <a href="/posts/snippets-in-vscode">
                        <h2>VSCode Snippets</h2>
                    </a>
                    <p>Posted on Thursday, 18 July 2024</p>
<p>I use Visual Studio Code to write markdown notes of my meetings. I datetime every meeting to be able to find it afterwards. One of the shorthands I use is 'dt'. I always forget how to set it up when I reinstall my vscode, so here's the instructions from github copilot chat, which explained how to set it up again!</p>
<p>So now I know I can ask Copilot how to do it, but I still want to document it, so here it is:</p>
<h3 id="github-copilot-instructions">Github Copilot Instructions</h3>
<p>To recreate the shorthand command in Visual Studio Code for inserting the current date and time in a Markdown file using <code>ctrl-space</code>, you can use a snippet. Here's how to set it up:</p>
<ol>
<li>Open the Command Palette with <code>Ctrl+Shift+P</code>.</li>
<li>Type <code>Configure User Snippets</code> and select it.</li>
<li>Choose <code>markdown.json</code> for Markdown files.</li>
<li>Insert the following snippet configuration:</li>
</ol>
<pre><code class="language-json">&quot;Insert Current Date and Time&quot;: {
    &quot;prefix&quot;: &quot;dt&quot;,
    &quot;body&quot;: [
        &quot;### $CURRENT_YEAR.$CURRENT_MONTH.$CURRENT_DATE $CURRENT_HOUR:$CURRENT_MINUTE:$CURRENT_SECOND&quot;
    ],
    &quot;description&quot;: &quot;Inserts the current date and time&quot;
}
</code></pre>
<ol start="5">
<li>Save the <code>markdown.json</code> file.</li>
</ol>
<p>Now, when you type <code>dt</code> in a Markdown file and press <code>Ctrl+Space</code>, it should suggest your snippet. Selecting it will insert the current date and time formatted as you described.</p>
						<hr>
                </div>       
                <div>
                    <a href="/posts/HowToUpdateWritebook">
                        <h2>Adding LaTeX Maths to Writebook</h2>
                    </a>
                    <p>Posted on Saturday, 13 July 2024</p>
<h1 id="how-to-add-latex-maths-to-writebook">How to add LaTeX maths to Writebook</h1>
<p>I've started using ONCE <a href="https://once.com/writebook">Writebook</a> to host some markdown documents, including my book on Optimization applied to energy products. But that book contains tons of Markdown LaTeX formatted mathematics, which Writebook does not support at this time.</p>
<p>So I patched support for it into the docker image.</p>
<h2 id="copy-out-the-app-layout-file">Copy out the app layout file</h2>
<p>Assuming your docker image is named writebook.</p>
<pre><code>sudo docker cp writebook:/rails/app/views/layouts/application.html.erb .
</code></pre>
<h2 id="modify-the-application-erb-to-add-support">Modify the application erb to add support</h2>
<p>In the Head Section add</p>
<pre><code> &lt;script type=&quot;text/javascript&quot;&gt;
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$']],
          displayMath: [['$$', '$$']],
          processEscapes: true
        }
      };
    &lt;/script&gt;
      
    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p>Thing is, it doesn't render the first time round, so I have to refresh the page to render, but it's not too much of an issue right now, I actually like to see the LaTeX maths code before I see the rendered version.</p>
<!--
Not working right now ! 

## How to add a render on end of page load to ensure it typesets first time

Above the ```</Body>``` tag at the bottom of the page, add
```
    <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
      MathJax.typeset();
    });
  </script>
```

-->
<h2 id="save-and-copy-the-file-back">Save and copy the file back</h2>
<p>Then finally copy the file back into the docker image and restart the image</p>
<pre><code>sudo docker cp application.html.erb writebook:/rails/app/views/layouts/application.html.erb
sudo docker restart writebook
</code></pre>
						<hr>
                </div>       
                <div>
                    <a href="/posts/HttpClientCompression">
                        <h2>Receiving compressed data from an http(s) endpoint</h2>
                    </a>
                    <p>Posted on Wednesday, 20 March 2024</p>
<p>With the amount of data that we are passing around across services, it is often beneficial to use compression on the data to reduce the transmission time. Modern platforms and algorithms are now very efficient at compressing regular data, particularly if that data is text or json data. </p>
<p>If the developer of the endpoint has prepared their service for compression, the client must still indicate that they are ready to receive the compressed data. Luckily, most implementations of modern http clients in R, Python, JavaScript and Dotnet support compression / decompression and are seamless for the client. This means that you can set the compression headers on and simply benefit from compressed data being received. </p>
<p>We can also check in the Content-Encoding header which compression was used. I've found that example.com is sending responses compressed with gzip.</p>
<h2 id="python">Python</h2>
<pre><code class="language-python">import requests

url = &quot;http://example.com&quot;  # Replace with the actual URL you want to request

# Specify the accepted encoding methods in the headers
headers = {
    'Accept-Encoding': 'gzip, br',
}

response = requests.get(url, headers=headers)
print(response.text)

# In case you want to see if it was compressed, you can check via the headers
#if 'Content-Encoding' in response.headers:
#    print(f&quot;Response was compressed using: {response.headers['Content-Encoding']}&quot;)
#else:
#    print(&quot;Response was not compressed.&quot;)
</code></pre>
<h2 id="r">R</h2>
<pre><code class="language-R">library(httr)

# The URL to which you're sending the request
url &lt;- &quot;http://example.com&quot;

# Setting the Accept-Encoding header
response &lt;- GET(url, add_headers(`Accept-Encoding` = 'gzip, br'))

# The content of the response will be automatically decompressed by httr, so you can access it directly.
content(response, &quot;text&quot;)
</code></pre>
<h2 id="c">C#</h2>
<p>In C#, for some ungodly strange reason, the standard HTTP endpoint doesn't decompress for you automatically unless you add a decompression handler - see handler <a href="https://learn.microsoft.com/en-us/dotnet/api/system.net.http.httpclienthandler.automaticdecompression?view=net-8.0#system-net-http-httpclienthandler-automaticdecompression">HttpClientHandler.AutomaticDecompression</a></p>
<pre><code class="language-Csharp">using System;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Threading.Tasks;
using System.Text;

class Program
{
    static async Task Main(string[] args)
    {
        HttpClientHandler handler = new HttpClientHandler();
        handler.AutomaticDecompression = System.Net.DecompressionMethods.GZip; //Adding automatic Decompression means that the accept headers are added automatically

        using (var client = new HttpClient(handler))
        {
            string url = &quot;http://example.com&quot;;
            HttpResponseMessage response = await client.GetAsync(url);
            response.EnsureSuccessStatusCode();

            Console.WriteLine(await response.Content.ReadAsStringAsync());
		}
	}
}
</code></pre>
<h2 id="javascript">JavaScript</h2>
<p>it is so easy that you don't even need to do anything else than setting the gzip: true for the support</p>
<pre><code class="language-JS">const request = require('request');
const requestOptions = {
  url: 'http://example.com',
  gzip: true, // This is all that is required
};
request(requestOptions, (error, response, body) =&gt; {
  // Handle the response here
});
</code></pre>
						<hr>
                </div>       
                <div>
                    <a href="/posts/devcontainers">
                        <h2>DevContainers - The future of developer environments</h2>
                    </a>
                    <p>Posted on Monday, 24 July 2023</p>
<h2 id="history">History</h2>
<p>It's been years now that we've had Infrastructure as Code (IaC), Containers and Desired state Configuration (DsC) tools to do our deployments. But these have been mostly focused on the deployment side of things, with fewer tools on the developer side. On the dev machine, installing and maintaining the development tools and package dependencies has been in flux, both in windows where finally tools like Ninite, Chocolatey and Winget allow management of dev tools, and on the linux side, which was always quite well served with apt - but has also gained Snap, Flatpack and other package management tools. The thing is, sometimes you need more that one version of a particular tool, Python3.10 and Python3.11, Java9 and Java17, Dotnet 4.8 and Dotnet 6, to work on the various projects you have during the day. Sometimes, they work side by side very well and sometimes they don't. And when they don't, it can be a long process to figure out why and also very difficult to get help without resorting to having a clean image refresh and starting again to install your dependencies.</p>
<p>Since the end of the 2010s and the early 2020s, with the rise of web hosted IDEs, there has been a need to define ways to have a base image that contained the environment and tools needed to work. I remember running some in the mid 2010s - Nitrous.IO (2013-16) - that allowed you to use a base container and configure it to do remote development.</p>
<h2 id="devcontainers">DevContainers</h2>
<p>With the arrival of Docker on every desktop, Github's Cloudspaces and Visual Studio Code, there's been a new interest in this type of desired state environments with developer tooling. Microsoft published the <a href="https://containers.dev/">DevContainer specification</a> in early 2022 to formalize the language.</p>
<p>So how does it help us? Well, with a DevContainer, we can setup a new development environment on Premise (in VSCode), on the cloud VM (Azure+VM) or on a Codespace environment with a single file that ensures that we always have the tools we want and need installed. Starting to work is as easy as openining the connection and cloning the repo we need if the .devcontainer file is located inside.</p>
<h2 id="devcontainer-example">DevContainer example</h2>
<p>You can find below my <a href="https://github.com/ewinnington/DevContainerTemplate/blob/master/.devcontainer/devcontainer.json">personal DevContainer</a>, it is setup with Git, Node, AzureCLI, Docker control of hose, Dotnet, Terraform, Java with Maven, Python3 and Postgresql. I also have the VSCode extensions directly configured so I can directly start using them when I connect. I also use the &quot;postStartCommand&quot;: &quot;nohup bash -c 'postgres &amp;'&quot; to run an instance of Postgresql directly inside the development container, so I can a directly have a DB to run requests against. And yes, this is a bit of a kitchen sink DevContainer, they can be smaller and more tailored to a project with only one or two of these features included, but here I use a generic one add added everything I use apart from the c++ and fortran compilers.</p>
<pre><code>{
    &quot;name&quot;: &quot;Erics-base-dev-container&quot;,
    &quot;image&quot;: &quot;mcr.microsoft.com/devcontainers/base:debian&quot;,
 
    &quot;features&quot;: {
        &quot;ghcr.io/devcontainers/features/git:1&quot;: {},
        &quot;ghcr.io/devcontainers/features/node:1&quot;: {},
        &quot;ghcr.io/devcontainers/features/azure-cli:1&quot;: {}, //azure-cli,
        &quot;ghcr.io/devcontainers/features/docker-outside-of-docker:1&quot;: {}, //docker on host
        &quot;ghcr.io/devcontainers/features/dotnet:1&quot;: {}, //dotnet installed
        &quot;ghcr.io/devcontainers/features/terraform:1&quot;: {},
        &quot;ghcr.io/devcontainers/features/java:1&quot;: { &quot;installMaven&quot; : true },
        &quot;ghcr.io/devcontainers-contrib/features/postgres-asdf:1&quot;: {}
    },
 
    // Configure tool-specific properties.
    &quot;customizations&quot;: {
        // Configure properties specific to VS Code.
        &quot;vscode&quot;: {
            &quot;settings&quot;: {},
            &quot;extensions&quot;: [
                &quot;streetsidesoftware.code-spell-checker&quot;,
                &quot;ms-azuretools.vscode-docker&quot;,
                &quot;ms-dotnettools.csharp&quot;,
                &quot;HashiCorp.terraform&quot;,
                &quot;ms-azuretools.vscode-azureterraform&quot;,
                &quot;GitHub.copilot&quot;,
                &quot;GitHub.copilot-chat&quot;,
                &quot;vscjava.vscode-java-pack&quot;,
                &quot;ms-python.python&quot;
            ]
        }
    },
 
    // Use 'forwardPorts' to make a list of ports inside the container available locally.
    // &quot;forwardPorts&quot;: [3000],
 
    // Use 'portsAttributes' to set default properties for specific forwarded ports.
    // More info: https://containers.dev/implementors/json_reference/#port-attributes
    &quot;portsAttributes&quot;: {
        &quot;3000&quot;: {
            &quot;label&quot;: &quot;Hello Remote World&quot;,
            &quot;onAutoForward&quot;: &quot;notify&quot;
        }
    },
 
    // Use 'postCreateCommand' to run commands after the container is created.
    &quot;postCreateCommand&quot;: &quot;&quot;,
 
    &quot;postStartCommand&quot;: &quot;nohup bash -c 'postgres &amp;'&quot;
 
    // Uncomment to connect as root instead. More info: https://aka.ms/dev-containers-non-root.
    // &quot;remoteUser&quot;: &quot;root&quot;
}
</code></pre>
<h2 id="so-how-do-you-start-with-devcontainers">So how do you start with DevContainers?</h2>
<p>There are 2 easy ways:</p>
<ol>
<li>(remote) Github Codespaces
By going to my repo, you can click &quot;Create Codespace on Master&quot; and get a running VSCode in the cloud with all those tools setup instantly.</li>
</ol>
<p>(at first build, the image might take time)</p>
<ol start="2">
<li>(local) Docker + VS Code
Ensure you have the <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers">ms-vscode-remote.remote-containers</a> extension installed in VS Code and Docker installed.</li>
</ol>
<p>Clone the repo <a href="https://github.com/ewinnington/DevContainerTemplate.git">https://github.com/ewinnington/DevContainerTemplate.git</a>, then open it with VSCode. It should automatically detect the .devContainer and offer to rebuild the container image and open it up in the IDE for you.</p>
<p>Once that is done, you should have access to a complete environment at the state you specified.</p>
<h2 id="whats-the-use-for-developers-at-corporations-where-computers-are-locked-down">What's the use for Developers at corporations where computers are locked down?</h2>
<p>I think that providing developer windows machine with Git, Docker, WSL2 installed and using VS Code or another IDE that supports DevContainers is an excellent way forwards in providing a good fast and stable environment for developers to work faster and more efficiently. Using this configuration, any person showing up to a Hackathon would be able to start working in minutes after cloning a repository. It would really simplify daily operations, since every repo can provide the correct .DevContainer configuration, or teams can share a DevContainer basic configuration.</p>
<p>This all simplifies operations, makes developer experience more consistent and increases productivity since you can move faster from one development environment to another in minutes. OnPrem → Remote VM → Cloudspace and back in minutes, without any friction.</p>
<p>All in all, I'm convinced it is a tool that both IT support must understand and master how to best provide access to, and for developers to understand the devContainer to benefit from it.</p>
<p>Have you used DevContainers? What is your experience?</p>
						<hr>
                </div>       
        <ul class="pager">
            <li class="previous">                
            </li>
            <li class="next">
            </li>
        </ul>
    </div>
    <div class="4u 12u$(medium)">

            <h5>Tags</h5>
            <ul class="actions small">
                    <li><a role="button" href="/tags/Migrated" class="button small">Migrated (38)</a></li>
                    <li><a role="button" href="/tags/Database" class="button small">Database (10)</a></li>
                    <li><a role="button" href="/tags/Thoughts" class="button small">Thoughts (10)</a></li>
                    <li><a role="button" href="/tags/CSharp" class="button small">CSharp (9)</a></li>
                    <li><a role="button" href="/tags/Jupyter-notebook" class="button small">Jupyter notebook (7)</a></li>
                    <li><a role="button" href="/tags/Dotnet-try" class="button small">Dotnet try (7)</a></li>
                    <li><a role="button" href="/tags/Architecture" class="button small">Architecture (7)</a></li>
                    <li><a role="button" href="/tags/Oracle" class="button small">Oracle (6)</a></li>
                    <li><a role="button" href="/tags/Rpi" class="button small">Rpi (4)</a></li>
                    <li><a role="button" href="/tags/Space" class="button small">Space (4)</a></li>
            </ul>
            <ul class="actions small">
                <li><a href="/tags" class="button small">View All Tags &rarr;</a></li>
            </ul>    

            <h5>Older Posts</h5>
            <ul>
                    <li><a href="/posts/Proxmox">Proxmox 8 on sub $200 mini PCs</a></li>
                    <li><a href="/posts/network-vpn">Network planning and VPN</a></li>
                    <li><a href="/posts/mini-pc">The era of the sub $200 PC</a></li>
                    <li><a href="/posts/learn-from-chatgpt-Crdt-OT">Learning concepts from chatGPT - Operational Transform and Conflict-free Replicated Data Types</a></li>
            </ul>
                <ul class="actions small">
                    <li><a href="/posts" class="button small">Archive &rarr;</a></li>
                </ul>

        
    </div> 
</div>
					</div>
				</div>
			</div>

			<!-- Footer -->
			<footer id="footer">
				<div class="inner">
    <section>
        <h2>Feeds</h2>
        <ul class="actions small vertical">
            <li><a href="/feed.rss" class="button small"><i class="fa fa-rss"></i> RSS Feed</a></li>
                        <li><a href="/feed.atom" class="button small"><i class="fa fa-rss"></i> Atom Feed</a></li>
        </ul>
    </section>
    <section>
    </section>
    <ul class="copyright">
        <li>Copyright © 2024</li>
        <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
        <li><a href="https://wyam.io">Generated by Wyam</a></li>
    </ul>
</div>

			</footer>

		</div>
		
		

		<!-- Scripts -->
		<script>hljs.initHighlightingOnLoad();</script>
		<script src="/assets/js/jquery.min.js"></script>
		<script src="/assets/js/skel.min.js"></script>
		<script src="/assets/js/util.js"></script>
		<!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
		<script src="/assets/js/main.js"></script>

	</body>

</html>
