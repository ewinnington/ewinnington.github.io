
<!DOCTYPE html>
<!--
	Phantom by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="en">

	<head>
		<title>Eric Winnington</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />		
        <link href="/assets/css/highlight.css" rel="stylesheet">
		<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
        <link href="/assets/css/override.css" rel="stylesheet" />

		<meta name="description" content="A collection of thoughts, code and snippets." />
		<link type="application/rss+xml" rel="alternate" title="Eric Winnington" href="/feed.rss" />
				<link type="application/atom+xml" rel="alternate" title="Eric Winnington" href="/feed.atom" />
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
		<link rel="icon" href="/favicon.ico" type="image/x-icon">

		<meta name="application-name" content="Eric Winnington" />
		<meta name="msapplication-tooltip" content="Eric Winnington" />
		<meta name="msapplication-starturl" content="/" />

		<meta property="og:title" content="Eric Winnington" /> 
		<meta property="og:type" content="website" />
		<meta property="og:url" content="http://ewinnington.github.io/" />
		<!-- TODO: More social graph meta tags -->

        <script src="/assets/js/highlight.pack.js"></script>   
		
        <meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@ewinnington" />
<meta name="twitter:title" content="Eric Winnington" />
<meta name="twitter:description" content="A collection of thoughts, code and snippets." />

<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
		
	</head>

	<body>
		<!-- Wrapper -->
		<div id="wrapper">

			<!-- Header -->
			<header id="header">
				<div class="inner">

					<!-- Logo -->
					<a href="/" class="logo">
						<span class="title">Eric Winnington</span>
					</a>

					<!-- Nav -->
					<nav>
						<ul>
							<li><a href="#menu">Menu</a></li>
						</ul>
					</nav>

				</div>
			</header>

			<!-- Menu -->
			<nav id="menu">
				<h2>Menu</h2>
				<ul>
					        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About Me</a></li>
        <li><a href="/videos">Videos on programming</a></li>

				</ul>
			</nav>

			<!-- Main -->
			<div id="main">
				<div class="inner">

    <header>
        <h1>A collection of thoughts, code and snippets.</h1>
    </header>

					
					<div id="content">
						
<div class="row">
    <div class="8u 12u$(medium)">
                <div>
                    <a href="/posts/jupyter-lp-10">
                        <h2>Introduction to linear programming with C# and OR-Tools inside Jupyter</h2>
                    </a>
                    <p>Posted on Thursday, 14 November 2019</p>
<h1 id="linear-programming">Linear programming</h1>
<p><a href="https://en.wikipedia.org/wiki/Linear_programming">Linear programming</a> (LP) is a method to provide an optimal solution to a problem defined by a set of linear constraints. It is very widely applied in engineering and science.</p>
<p>A typical linear programming problem is defined by an Objective function (the target to maximise or minimise) and a set of constraints which limit the solution space.</p>
<h2 id="what-does-an-lp-problem-look-like">What does an LP problem look like?</h2>
<p>We are going to start with a very simple linear problem definition. The first line of the problem describes the objective function, in this the value to maximize. In this problem, we have two variables to optimize x and y. The constraints that limit the problem's space are defined under the subject to section.</p>
<div class="math">
\[
\begin{aligned}
\max (2y+x) \\
\text{subject to:} \\
\qquad x \leq 15 \\
\qquad y \leq 8 
\end{aligned}
\]</div>
<p>This very simple maximisation problem has a maximum solution of <span class="math">\(x=15\)</span> and <span class="math">\(y=8\)</span> for an objective value of <span class="math">\(31\)</span> .</p>
<p><img src="/posts/images/lp/A1.png" class="img-fluid" width="100%" alt="A1" /></p>
<p>There exist many linear programming solvers to calculate this optimum. We will be using <a href="https://github.com/coin-or/Clp">Coin-OR project CLP</a> with the <a href="https://developers.google.com/optimization">Google OR-Tools</a> as an interface for C#.</p>
<h2 id="meet-the-solver">Meet the solver</h2>
<p>You can find my <a href="https://github.com/ewinnington/noteb/blob/master/IntroToLP.ipynb">notebook with all the code here</a>.<a id="fnref:1" href="#fn:1" class="footnote-ref"><sup>1</sup></a></p>
<h3 id="coin-or-clp-with-google-or-tools">Coin-OR<a id="fnref:2" href="#fn:2" class="footnote-ref"><sup>2</sup></a> CLP (with Google OR<a id="fnref:3" href="#fn:2" class="footnote-ref"><sup>2</sup></a>-Tools)</h3>
<p>The <a href="https://www.coin-or.org">Coin-OR project</a> provides high quality solvers for many applications with an open source license. <a href="https://github.com/coin-or/Clp">CLP</a> is the main linear programming solver we will be using until we start adding binary variables, at which point we will start using <a href="https://github.com/coin-or/Cbc">CBC</a>. To call them from C#, we could write out a format that CLP / CBC knows how to read, such as <a href="https://en.wikipedia.org/wiki/MPS_(format)">MPS</a> or we could use a wrapping library to call them directly from C#. We will be focusing on using the Google OR-Tools.</p>
<h4 id="google-or-tools">Google OR-Tools</h4>
<p>The <a href="https://developers.google.com/optimization/">Google OR-Tools</a> provide us with a set of primitives with which to work with so that we can define optimisation problems and allow us to call to various solvers, including CLP, which we will be using. Also the OR-Tools provide routines to write out the problems in MPS and other formats. We will focus on using the OR Tools as soon as the introduction is over.</p>
<p>Adding the Google OR Tools through nuget to the Juypter notebook with the <code>#r</code> command and <code>using</code> in the cell imports the solver.</p>
<pre><code class="language-CSharp">#r &quot;nuget:Google.OrTools&quot;

using Google.OrTools.LinearSolver;
</code></pre>
<p><img src="/posts/images/lp/10-1.png" class="img-fluid" alt="10-1.png" /></p>
<p>This allows us to create a solver instance as follows, note the constant <code>CLP_LINEAR_PROGRAMMING</code> this tells us which solver we will be using.</p>
<pre><code class="language-CSharp">Solver solver = Solver.CreateSolver(&quot;LinearProgramming&quot;, &quot;CLP_LINEAR_PROGRAMMING&quot;);
</code></pre>
<p>The following code snippet implements the linear program formulation below<a id="fnref:4" href="#fn:3" class="footnote-ref"><sup>3</sup></a>:</p>
<div class="math">
\[
\begin{aligned}
\max (2y+x) \\
\text{subject to:} \\
\qquad x \leq 15 \\
\qquad y \leq 8 
\end{aligned}
\]</div>
<p>The solver has been already defined and initalized. We are now defining the variables of the problem, the objective function and the linear constraints that apply.</p>
<pre><code class="language-CSharp">Variable x = solver.MakeNumVar(0.0, double.PositiveInfinity, &quot;x&quot;);
Variable y = solver.MakeNumVar(0.0, double.PositiveInfinity, &quot;y&quot;);

// Maximize 2*y+x.
Objective objective = solver.Objective();
objective.SetCoefficient(x, 1);
objective.SetCoefficient(y, 2);
objective.SetMaximization();

// 0 &lt;= x &lt;= 15 
Constraint c0 = solver.MakeConstraint(0, 15);
c0.SetCoefficient(x, 1);

// 0 &lt;= y &lt;= 8
Constraint c1 = solver.MakeConstraint(0, 8);
c1.SetCoefficient(y, 1);
</code></pre>
<p><img src="/posts/images/lp/10-2.png" class="img-fluid" alt="10-2.png" /></p>
<p>When you execute the next cells, the solver.Solve() function is called and the results will be written out to the cell's output. We will use this function cell several times over the course of the workbook.</p>
<pre><code class="language-CSharp">public void SolveProblem() {
    var resultStatus = solver.Solve();

    // Check that the problem has an optimal solution.
    if (resultStatus != Solver.ResultStatus.OPTIMAL)
    {
        Console.WriteLine(&quot;The problem does not have an optimal solution!&quot;);
        return;
    }

    Console.WriteLine(&quot;Problem solved in &quot; + solver.WallTime() + &quot; milliseconds&quot;);

    // The objective value of the solution.
    Console.WriteLine(&quot;Optimal objective value = &quot; + solver.Objective().Value());

    // The value of each variable in the solution.
    foreach (var v in solver.variables())
    { Console.WriteLine($&quot;{v.Name()} : {v.SolutionValue()} &quot;); };
}
</code></pre>
<p><img src="/posts/images/lp/10-3.png" class="img-fluid" alt="10-3.png" /></p>
<h3 id="other-solvers">Other solvers</h3>
<p>There exists many other solvers that are available, either directly wrapped through the Google OR Tools such as GLOP or another library or as external programs fed through input files in MPS or other formats. The <a href="https://neos-server.org/neos/">NEOS project</a> provides a thorough set of optimisation solvers that are available online with many input formats available (MPS, AMPL, Lp, GAMS).</p>
<h2 id="problem-2">Problem 2</h2>
<p>We will be adding a third constraint to the formulation of Problem 1.</p>
<div class="math">
\[
\begin{aligned}
\text{Obj:} \max(2y+x)
\\ \text{subject to:} \quad x \leq 15
\\ \qquad \quad \quad \quad y \leq 8
\\ \quad \quad \quad x+y \leq 18
\end{aligned}
\]</div>
<p><img src="/posts/images/lp/A2.png" class="img-fluid" width="100%" alt="A2" /></p>
<p>The solver is initialized with the full problem 1 defintion already, x and y are already declared. When you click run on the solver's cell, the solver.Solve() function is called and results are written out.</p>
<pre><code class="language-CSharp">Constraint c = solver.MakeConstraint(0, 18);
c.SetCoefficient(x, 1);
c.SetCoefficient(y, 1);
</code></pre>
<p>If you call <code>SolveProblem();</code>, you will now have a new optimal value that is lower that the previous one. In linear programming maximization problem, adding a new constraint will always make the optimal value lower or equal to the less constrained. problem</p>
<p><img src="/posts/images/lp/10-4.png" class="img-fluid" alt="10-4.png" /></p>
<h2 id="problem-3">Problem 3</h2>
<p>You should now be able to add an adding a fourth constraint to the formulation of Problem 2.</p>
<div class="math">
\[
\begin{aligned}
\text{Obj:} \max(2y+x)
\\ \text{subject to:} \qquad x \leq 15
\\ \qquad \quad y \leq 8
\\ \quad x+y \leq 18
\\ -\frac{1}{3}x+y \leq 2
\end{aligned}
\]</div>
<p><img src="/posts/images/lp/A3.png" class="img-fluid" width="100%" alt="A3" /></p>
<p>The solver is initialized with the full problem 2 defintion already, x and y are already declared. When you click on the solver's cell, the solver.Solve() function is called and results are written out.</p>
<p><img src="/posts/images/lp/10-5.png" class="img-fluid" width="100%" alt="10-5.png" /></p>
<p>For those following along in the <a href="https://github.com/ewinnington/noteb/blob/master/IntroToLP.ipynb">notebook</a> there is a hint below this section with a second implementation of the <code>SolveProblem()</code> function which should give you hints based on your objective value.</p>
<h2 id="recap">Recap</h2>
<p>Now that we have introduced linear programming and know how to use the solver, the following chapter will cover two simple linear programming applications.</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn:1">
<p>I'm still waiting on a good way to host it in a live and executable mode online in Jupyter notebook C#. This whole tutorial was originally written as a dotnet-try workbook.<a href="#fnref:1" class="footnote-back-ref">&#8617;</a></p>
</li>
<li id="fn:2">
<p>OR here refers to <a href="https://en.wikipedia.org/wiki/Operations_research">Operational Research</a> - the field of mathematics dedicated to the search for optimal or near optimal solutions to problems.<a href="#fnref:2" class="footnote-back-ref">&#8617;</a><a href="#fnref:3" class="footnote-back-ref">&#8617;</a></p>
</li>
<li id="fn:3">
<p>For those using <a href="/posts/Switching-to-wyam">Wyam to generate their blogs</a>, you can add the</p>
<pre><code class="language-HTML">&lt;script type=&quot;text/javascript&quot; id=&quot;MathJax-script&quot; async
src=&quot;https://cdn.jsdelivr.net/npm/mathjax&#64;3/es5/tex-mml-chtml.js&quot;&gt;
&lt;/script&gt;
</code></pre>
<p>to your <code>_Head.cshtml</code> template page. I recommend checking out <a href="https://www.mathjax.org/">MathJax</a> for the latest <a href="http://docs.mathjax.org/en/latest/web/start.html#using-mathjax-from-a-content-delivery-network-cdn">CDN</a>.<a href="#fnref:4" class="footnote-back-ref">&#8617;</a></p>
</li>
</ol>
</div>
                </div>       
                <div>
                    <a href="/posts/jupyter-docker-csharp-postgres">
                        <h2>Docker controlled from Jupyter Notebook C# with PostgresDB</h2>
                    </a>
                    <p>Posted on Tuesday, 12 November 2019</p>
<p>In the context of Docker and Jupyter Notebook, it's interesting to note that there exists a Nuget that allows C# to control docker. So, yes, it is possible to launch a Postgresql database, on docker, inside a Jupyter notebook!</p>
<p>This assumes you have <a href="https://hub.docker.com/?overlay=onboarding">Docker</a>, <a href="https://github.com/dotnet/try/blob/master/DotNetTryLocal.md">Dotnet try</a>, <a href="https://jupyter.org/">Jupyter notebook</a> and follow the setup of the <a href="/posts/jupyter-notebook-csharp-r">C# kernel for Jupyter</a>.</p>
<p>If you don't want to wait, you can find my <a href="https://github.com/ewinnington/noteb/blob/master/DockerInteraction.ipynb">complete notebook here</a>.</p>
<p>Microsoft has created a <a href="https://github.com/microsoft/Docker.DotNet">C# Client library for talking to Docker</a>, so we will be taking advantage of it. Much of the magic docker code is pulled from the Docker.DotNet repository.
I'm using the <a href="https://www.npgsql.org/index.html">Npgsql drivers</a> for accessing the PostgreSQL database.
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-01.png" class="img-fluid" alt="pgsql01" /></p>
<p>The real magic moment is when you access the Docker instance, if it is on your local machine on windows, you can use the <code>npipe://./pipe/docker_engine</code> Uri. If you are on Linux, use <code>unix:///var/run/docker.sock</code> (at this time, I haven't tried it on linux, but if you do, please tell me).
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-02.png" class="img-fluid" alt="pgsql02" /></p>
<p>In block 3, we select a random port to host the pgSQL database. Then list the local image names that are available (you should get postgres:latest on your machine to run this). We create and start up the container, passing the environment variables for the password, user and initial schema. Once the container is started, we detach ourselves from it, so it runs in the background. Finally, I wait until I'm pretty sure the container and database is ready (10s sleep at the end). You can reduce that sleep time. On my Surface laptop 1, I sometimes have an issue when I've got too many other containers running.
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-03.png" class="img-fluid" alt="pgsql03" /></p>
<p>I'm connecting to the database and validating the connection name.
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-04.png" class="img-fluid" alt="pgsql04" /></p>
<p>I'm creating a database schema and a user for this particular schema, then reconning with the new user.
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-05.png" class="img-fluid" alt="pgsql05" /></p>
<p>Creating a table and inserting two rows using direct strings and string concatenation. In production, you should never be using string concatenation for your SQL statements. Please always use Bound variables as described below.
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-06.png" class="img-fluid" alt="pgsql06" /></p>
<p>This is how you should interact with the PostgreSQL database if you are using direct SQL statements. You should be using Bound commands with parameters.
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-07.png" class="img-fluid" alt="pgsql07" /></p>
<p>Finally, I check that all three insertions were successful.
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-08.png" class="img-fluid" alt="pgsql08" /></p>
<p>You can watch the container run in the <a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker">docker extension</a> of <a href="https://code.visualstudio.com/">Visual studio Code</a>. It's a great way of monitoring what is currently running, as well as deleting old containers that might be still present.
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-10.png" class="img-fluid" alt="pgsql10" /></p>
<p>Talking of deleting old containers, this is how you shut them down and delete them at the end of the notebook. I first close the Db connection and dispose of it before asking Docker.DotNet to stop the containers.
<img src="/posts/images/jupyter-notebook-csharp-r/docker-pg-09.png" class="img-fluid" alt="pgsql09" /></p>
<p>It would be cleaner if I knew how to enfore a <code>Finally</code> in Jupyter Notebook, but at this time, I don't know. If you do, drop me a line on <a href="https://twitter.com/ThrowATwit">twitter</a> or a pull request on this blog post.</p>
                </div>       
                <div>
                    <a href="/posts/jupyter-sqlite-csharp">
                        <h2>Testing SQLite in C# Jupyter notebook</h2>
                    </a>
                    <p>Posted on Tuesday, 12 November 2019</p>
<p>Now that we have <a href="/posts/jupyter-notebook-csharp-r">Jupyter Notebooks with C# installed</a>, using it as an environment to play with SQLite is very easy. <a href="https://www.sqlite.org/index.html">SQLite</a> is a relational database that is small in footprint and self-contained. It also has a great in-memory mode which is perfect for playing around in a Jupyter notebook.</p>
<p>You can access my <a href="https://github.com/ewinnington/noteb/blob/master/SqliteInteraction.ipynb">SQLite example notebook here</a>. (<em>Note, if you can tell me how to host them online to make them executable, drop me a line on <a href="https://twitter.com/ThrowATwit">twitter</a></em>)</p>
<p>You can create a C# Notebook from the file menu of Jupyter.</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/new-notebook.png" class="img-fluid" alt="new-notebook" /></p>
<p>We need to pull in the nuget package <code>System.Data.SQLite</code> to interact with the database.</p>
<pre><code class="language-CSharp">#r &quot;nuget:System.Data.SQLite&quot;
using System.Data.SQLite;
</code></pre>
<p><code>#r</code> is used to reference a dll or a nuget package. If you prefix the command with &quot;nuget:&quot; then the jupyter notebook will download the nuget and add it as a reference. Then as in usual c#, you must reference it.</p>
<p>When you run this cell, you should see the following output:</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/sqlite01.png" class="img-fluid" alt="sqlite01" /></p>
<p>We can then create a connection to an in-memory SQLite database.</p>
<pre><code class="language-CSharp">SQLiteConnection conn;

conn = new SQLiteConnection(&quot;Data Source=:memory:;Version=3;New=True;&quot;);

try
{
conn.Open();
}
catch (Exception ex)
{
Console.WriteLine(ex); 
}
</code></pre>
<p>Creating two identical tables <em>SampleTable</em> and <em>SampleTable1</em>.</p>
<pre><code>using (SQLiteCommand sqlite_cmd = conn.CreateCommand()) {
    string Createsql = &quot;CREATE TABLE SampleTable(Col1 VARCHAR(20), Col2 INT)&quot;;
    string Createsql1 = &quot;CREATE TABLE SampleTable1(Col1 VARCHAR(20), Col2 INT)&quot;;
    sqlite_cmd.CommandText = Createsql;
    sqlite_cmd.ExecuteNonQuery();
    sqlite_cmd.CommandText = Createsql1;
    sqlite_cmd.ExecuteNonQuery();
}
</code></pre>
<p>Inserting a set of data into these tables.</p>
<pre><code>using (SQLiteCommand sqlite_cmd = conn.CreateCommand()) {
    sqlite_cmd.CommandText = &quot;INSERT INTO SampleTable(Col1, Col2) VALUES ('Test Text ', 1);&quot;;
    sqlite_cmd.ExecuteNonQuery();
    sqlite_cmd.CommandText = &quot;INSERT INTO SampleTable(Col1, Col2) VALUES ('Test1 Text1 ', 2);&quot;;
    sqlite_cmd.ExecuteNonQuery();
    sqlite_cmd.CommandText = &quot;INSERT INTO SampleTable(Col1, Col2) VALUES ('Test2 Text2 ', 3);&quot;;
    sqlite_cmd.ExecuteNonQuery();
    sqlite_cmd.CommandText = &quot;INSERT INTO SampleTable1(Col1, Col2) VALUES ('Test3 Text3 ', 3);&quot;;
    sqlite_cmd.ExecuteNonQuery();
}
</code></pre>
<p>Reading from <em>SampleTable</em> to verify the insertions went through correctly.</p>
<pre><code>using (SQLiteCommand sqlite_cmd = conn.CreateCommand()) {
    sqlite_cmd.CommandText = &quot;SELECT * FROM SampleTable&quot;;

    using(var sqlite_datareader = sqlite_cmd.ExecuteReader()){
        while (sqlite_datareader.Read())
        {
        string myreader = sqlite_datareader.GetString(0);
        Console.WriteLine(myreader);
        }
    }
}
</code></pre>
<p>If you executed the whole workbook up to now, you should have the following output.</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/sqlite05.png" class="img-fluid" alt="sqlite05" /></p>
<p>Closing the connection to the databse.</p>
<pre><code>conn.Close();
</code></pre>
                </div>       
                <div>
                    <a href="/posts/jupyter-notebook-csharp-r">
                        <h2>Jupyter notebook with C# and R</h2>
                    </a>
                    <p>Posted on Tuesday, 12 November 2019</p>
<p>Following the release of the <a href="https://devblogs.microsoft.com/dotnet/net-core-with-juypter-notebooks-is-here-preview-1/">updated dotnet try tool</a>, here are my instructions for getting started.</p>
<h1 id="installing-jupyter-notebook-with-a-c-kernel">Installing jupyter notebook with a c# kernel</h1>
<ul>
<li>Check if you installed python with visual studio.</li>
</ul>
<p>Go to the start menu and start typing Python</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/python_installed.png" class="img-fluid" :height="360px" width="620px" alt="img1" /></p>
<p>Right click on python and follow the Open File Location until you find the place where python is installed.</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/python_installed_location.png" class="img-fluid" :height="360px" width="620px" alt="img2" /></p>
<ul>
<li><p>Or type: <code>where python</code> in the command line.</p>
</li>
<li><p>If so, add python to the PATH of your environment. On my installation, the paths to Python were as follows. I had to add the Scripts path for the pip installation to be in the command line.</p>
<ul>
<li><code>C:\Program Files (x86)\Microsoft Visual Studio\Shared\Python37_64\</code></li>
<li><code>C:\Program Files (x86)\Microsoft Visual Studio\Shared\Python37_64\Scripts</code></li>
</ul>
</li>
<li><p>install jupyter using pip which was installed with visual studio, make sure to run in an <strong>administrator</strong> shell
<code>pip install jupyter</code></p>
</li>
<li><p>Now get the list of installed jupyter kernels:
<code>jupyter kernelspec list</code></p>
</li>
</ul>
<pre><code>Available kernels:
  c:\program files (x86)\microsoft visual studio\shared\python37_64\share\jupyter\kernels\python3  
</code></pre>
<ul>
<li><p>Install the latest version of .net try
<code>dotnet tool install dotnet-try -g</code></p>
</li>
<li><p>finally install the .net kernel for jupyter with the command:
<code>dotnet try jupyter install</code></p>
</li>
<li><p>test the kernel is now installed with <code>jupyter kernelspec list</code></p>
</li>
</ul>
<p><img src="/posts/images/jupyter-notebook-csharp-r/jupyter_kernels.png" class="img-fluid" alt="img3" /></p>
<h1 id="launch-jupyter-notebook">launch jupyter notebook</h1>
<p>In the command line, type:
<code>jupyter notebook</code></p>
<p>A browser window should open and the terminal should display:</p>
<pre><code>C:\Repos\noteb&gt;jupyter notebook
[I 22:14:55.617 NotebookApp] JupyterLab extension loaded from c:\program files (x86)\microsoft visual studio\shared\python37_64\lib\site-packages\jupyterlab
[I 22:14:55.618 NotebookApp] JupyterLab application directory is c:\program files (x86)\microsoft visual studio\shared\python37_64\share\jupyter\lab
[I 22:14:55.625 NotebookApp] Serving notebooks from local directory: C:\Repos\noteb
[I 22:14:55.626 NotebookApp] The Jupyter Notebook is running at:
[I 22:14:55.627 NotebookApp] http://localhost:8888/?token=XXXXXXXXXXXXXXXXXXXc1ee1dfccc0a6624263d584b8ca4c
[I 22:14:55.628 NotebookApp]  or http://127.0.0.1:8888/?token=XXXXXXXXXXXXXXXXXXXc1ee1dfccc0a6624263d584b8ca4c
[I 22:14:55.629 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).  [C 22:14:55.737 NotebookApp]

    To access the notebook, open this file in a browser:
        file:///C:/Users/xxxxxx/AppData/Roaming/jupyter/runtime/nbserver-17608-open.html
    Or copy and paste one of these URLs:
        http://localhost:8888/?token=XXXXXXXXXXXXXXXXXXXc1ee1dfccc0a6624263d584b8ca4c
     or http://127.0.0.1:8888/?token=XXXXXXXXXXXXXXXXXXXc1ee1dfccc0a6624263d584b8ca4c
[I 22:15:16.852 NotebookApp] Kernel started: be6910a0-92f0-4ec0-a26c-d8274b44cd6d
</code></pre>
<p>The main page of the Jupyter notebook allows you to see the notebooks available in the folder and to create new ones.</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/jupyter_create_csharp.png" class="img-fluid" :height="360px" width="620px" alt="img4" /></p>
<h1 id="hello-world">Hello world</h1>
<p>Create a new C# notebook. Then type</p>
<pre><code class="language-CSharp">using System; 
</code></pre>
<p>in the first cell. I executed it and then typed:</p>
<pre><code class="language-CSharp">Console.WriteLine(&quot;Hello World&quot;); 
</code></pre>
<p>in the second cell. Executing it shows us that the C# Kernel is working.</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/jupyter_hello_world_csharp.png" class="img-fluid" :height="360px" width="620px" alt="imgHello" /></p>
<p><code>#r</code> is used to reference a dll or a nuget package. If you prefix the command with &quot;nuget:&quot; then the jupyter notebook will download the nuget and add it as a reference. Then as in usual c#, you must reference it.</p>
<h1 id="installing-an-r-kernel-for-jupyter-notebook">Installing an R kernel for jupyter notebook</h1>
<p>To install R Tools for Visual Studio, install the Visual Studio Extension R Tools for Visual Studio 2019, which was in preview when I looked. Once this is installed, you must install the Microsoft R client. This option will be presented if you go to the &quot;R Interactive&quot; window.</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/install_R_vs.png" class="img-fluid" :height="360px" width="620px" alt="img5" /></p>
<p>I have R installed with visual studio, so I launched visual studio in <strong>admin mode</strong> to be able to have my R directory writable, went to the R Tools menu at the top and selected &quot;R Interactive&quot;.</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/r_interactive_vs.png" class="img-fluid" alt="img6" /></p>
<p>From the command line of R, I typed in the following commands. <a href="https://irkernel.github.io/installation/">Installation guide R</a></p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/r_interactive_kernel_install.png" class="img-fluid" alt="img6" /></p>
<pre><code class="language-R">install.packages('IRkernel')
IRkernel::installspec(user = FALSE)
</code></pre>
<p>I got the following output after installing the IRKernel into Jupyter <code>[InstallKernelSpec] Installed kernelspec ir in C:\ProgramData\jupyter\kernels\ir</code>. Following this, you can check on the command line that the R kernel appears in the list of Jupyter Kernels with <code>jupyter kernelspec list</code>, this should show the ir kernel installed:</p>
<pre><code>Available kernels:
  ir             C:\ProgramData\jupyter\kernels\ir
</code></pre>
<h2 id="use-r-to-show-a-some-math">Use R to show a some math</h2>
<p>Create a new R notebook and type in the first cell:</p>
<pre><code class="language-R">demo(plotmath)
</code></pre>
<p>Executing this should show you the following long list of tables with mathematical symbols.</p>
<p><img src="/posts/images/jupyter-notebook-csharp-r/jupyter_R.png" class="img-fluid" :height="360px" width="620px" alt="img7" /></p>
                </div>       
        <ul class="pager">
            <li class="previous">                
            </li>
            <li class="next">
            </li>
        </ul>
    </div>
    <div class="4u 12u$(medium)">

            <h5>Tags</h5>
            <ul class="actions small">
                    <li><a role="button" href="/tags/Migrated" class="button small">Migrated (38)</a></li>
                    <li><a role="button" href="/tags/CSharp" class="button small">CSharp (5)</a></li>
                    <li><a role="button" href="/tags/CommandLine" class="button small">CommandLine (4)</a></li>
                    <li><a role="button" href="/tags/Dotnet-try" class="button small">Dotnet try (4)</a></li>
                    <li><a role="button" href="/tags/Oracle" class="button small">Oracle (4)</a></li>
                    <li><a role="button" href="/tags/Jupyter-notebook" class="button small">Jupyter notebook (4)</a></li>
                    <li><a role="button" href="/tags/WPF" class="button small">WPF (4)</a></li>
                    <li><a role="button" href="/tags/Rpi" class="button small">Rpi (4)</a></li>
                    <li><a role="button" href="/tags/OSX" class="button small">OSX (3)</a></li>
                    <li><a role="button" href="/tags/R" class="button small">R (3)</a></li>
            </ul>
            <ul class="actions small">
                <li><a href="/tags" class="button small">View All Tags &rarr;</a></li>
            </ul>    

            <h5>Older Posts</h5>
            <ul>
                    <li><a href="/posts/bulk-inserts">Using bulk inserts on databases</a></li>
                    <li><a href="/posts/webassembly-thoughts">Reflections on Webassembly - May/Nov 19</a></li>
                    <li><a href="/posts/wyam-github-actions">Using Github actions to build Wyam and publish to github pages</a></li>
                    <li><a href="/posts/R-Redis-Json">R - Reading JSON from redis</a></li>
            </ul>
                <ul class="actions small">
                    <li><a href="/posts" class="button small">Archive &rarr;</a></li>
                </ul>

        
    </div> 
</div>

					</div>
				</div>
			</div>

			<!-- Footer -->
			<footer id="footer">
				<div class="inner">
    <section>
        <h2>Feeds</h2>
        <ul class="actions small vertical">
            <li><a href="/feed.rss" class="button small"><i class="fa fa-rss"></i> RSS Feed</a></li>
                        <li><a href="/feed.atom" class="button small"><i class="fa fa-rss"></i> Atom Feed</a></li>
        </ul>
    </section>
    <section>
    </section>
    <ul class="copyright">
        <li>Copyright © 2019</li>
        <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
        <li><a href="https://wyam.io">Generated by Wyam</a></li>
    </ul>
</div>

			</footer>

		</div>
		
		

		<!-- Scripts -->
		<script>hljs.initHighlightingOnLoad();</script>
		<script src="/assets/js/jquery.min.js"></script>
		<script src="/assets/js/skel.min.js"></script>
		<script src="/assets/js/util.js"></script>
		<!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
		<script src="/assets/js/main.js"></script>

	</body>

</html>
